<view class="container">
  
  <!-- 1. é¡¶éƒ¨çŠ¶æ€æ  (ä»¿ç…§ practice é£æ ¼) -->
  <view class="header">
    <view class="grade-info">
      <view class="rank-badge">ğŸš€ æ‹“å±•æŒ‘æˆ˜</view>
      <text class="grade-name">{{gradeName}}</text>
      <view class="time-capsule">
        <icon type="waiting" size="14" color="#3498db"/>
        <text class="time-text">{{formattedTime}}</text>
      </view>
    </view>
    
    <!-- è¿›åº¦æ¡ -->
    <view class="progress-info">
      <text class="progress-label">è¿›åº¦ {{currentQuestion}} / {{totalQuestions}}</text>
      <progress 
        class="progress-bar" 
        percent="{{progressPercent}}" 
        stroke-width="10" 
        activeColor="#3498db" 
        backgroundColor="#f0f2f5" 
        border-radius="10"
        active
        duration="10"
      />
    </view>

    <!-- å®æ—¶å¾—åˆ†æ¿ (æ–°å¢) -->
    <view class="score-board">
      <view class="score-item">
        <text class="score-val correct">+{{score}}</text>
        <text class="score-lbl">å¾—åˆ†</text>
      </view>
      <view class="score-item border-left">
        <text class="score-val">{{correctCount}}</text>
        <text class="score-lbl">æ­£ç¡®</text>
      </view>
      <view class="score-item border-left">
        <text class="score-val wrong">{{wrongCount}}</text>
        <text class="score-lbl">é”™è¯¯</text>
      </view>
    </view>
  </view>

  <!-- 2. é¢˜ç›®å¡ç‰‡åŒº -->
  <view class="question-card">
    <view class="card-header">
      <text class="q-tag">é¢˜ç›® {{currentQuestion}}</text>
      <text class="q-score-tag">âœ¨ åŒå€ç§¯åˆ†</text>
    </view>

    <view class="question-content">
      <!-- é¢˜ç›®æ–‡æœ¬ -->
      <text class="question-text">{{question}}</text>
      
      <!-- ç­”æ¡ˆæ˜¾ç¤ºåŒºï¼šæ¨¡ä»¿è¾“å…¥æ¡†æ ·å¼ -->
      <view class="answer-display-wrapper {{userAnswer ? 'has-value' : ''}}">
        <text class="answer-text">{{userAnswer}}</text>
        <!-- åªæœ‰åœ¨æ•°å­—æ¨¡å¼ä¸”æœªå¡«æ»¡æ—¶æ˜¾ç¤ºå…‰æ ‡ -->
        <view class="cursor" wx:if="{{inputType === 'number' && userAnswer.length < 5}}"></view>
        <text class="placeholder" wx:if="{{!userAnswer}}">?</text>
      </view>
    </view>
  </view>

  <!-- 3. åº•éƒ¨æ“ä½œåŒº (æ ¹æ® inputType å˜åŒ–) -->
  
  <!-- A. ç¬¦å·/æ¯”å¤§å°é€‰æ‹© (æ‚¬æµ®å¡ç‰‡é£æ ¼) -->
  <view class="options-panel" wx:if="{{inputType !== 'number'}}">
    <view class="options-title">è¯·é€‰æ‹©ç¬¦å·</view>
    <view class="options-grid">
      <block wx:for="{{options}}" wx:key="*this">
        <button 
          class="opt-btn" 
          hover-class="opt-btn-hover" 
          bindtap="onOptionSelect" 
          data-val="{{item}}">
          {{item}}
        </button>
      </block>
    </view>
  </view>

  <!-- B. æ•°å­—é”®ç›˜ (å›ºå®šåº•éƒ¨è®¡ç®—å™¨é£æ ¼) -->
  <view class="calculator-keypad" wx:else>
    <view class="keypad-header">
      <view class="keypad-hint">è¯·è¾“å…¥ç­”æ¡ˆ</view>
      <!-- é€€æ ¼é”®æ”¾åœ¨è¿™é‡Œæˆ–è€…é”®ç›˜é‡Œå‡å¯ï¼Œè¿™é‡Œæ”¾é”®ç›˜é‡Œ -->
    </view>

    <!-- ç¬¬ä¸€è¡Œ: 7 8 9 -->
    <view class="key-row">
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="7">7</button>
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="8">8</button>
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="9">9</button>
    </view>
    <!-- ç¬¬äºŒè¡Œ: 4 5 6 -->
    <view class="key-row">
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="4">4</button>
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="5">5</button>
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="6">6</button>
    </view>
    <!-- ç¬¬ä¸‰è¡Œ: 1 2 3 -->
    <view class="key-row">
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="1">1</button>
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="2">2</button>
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="3">3</button>
    </view>
    <!-- ç¬¬å››è¡Œ: åˆ é™¤ 0 ç¡®å®š -->
    <view class="key-row">
      <button class="key del" hover-class="del-hover" bindtap="onDelete">âŒ«</button>
      <button class="key" hover-class="key-hover" bindtap="onKeyTap" data-key="0">0</button>
      <button class="key submit" hover-class="submit-hover" bindtap="submitAnswer">ç¡®å®š</button>
    </view>
  </view>

</view>
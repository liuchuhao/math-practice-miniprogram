<!-- pages/math_game/twentyfour/twentyfour.wxml -->
<view class="container">
  
  <!-- 1. é¡¶éƒ¨æ ï¼šå¢åŠ ç§¯åˆ†æ˜¾ç¤º -->
  <view class="header">
    <view class="stats-group">
      <!-- è¿èƒœæ˜¾ç¤º -->
      <view class="score-box">
        <text class="label">è¿èƒœ</text>
        <text class="val">{{score}}</text>
      </view>
      <!-- åˆ†å‰²çº¿ -->
      <view class="divider"></view>
      <!-- ç§¯åˆ†æ˜¾ç¤º -->
      <view class="score-box">
        <text class="label">ç´¯è®¡ç§¯åˆ†</text>
        <text class="val">{{points}}</text>
      </view>
    </view>

    <!-- æ—¶é—´ -->
    <view class="timer-box">
      <text class="time-text">{{timeStr}}</text>
    </view>

    <!-- è·³è¿‡æŒ‰é’® -->
    <view class="btn-box" bindtap="nextLevel" hover-class="btn-hover">
      <text>è·³è¿‡</text>
    </view>
  </view>

  <!-- 2. ç‰Œæ¡ŒåŒºåŸŸ -->
  <view class="table-area">
    <view class="card-list">
      <block wx:for="{{cards}}" wx:key="id">
        <view 
          class="poker-card {{selectedIdx === index ? 'selected' : ''}}" 
          bindtap="onCardTap" 
          data-index="{{index}}"
        >
          <!-- å·¦ä¸Šè§’æ ‡ï¼šæ•°å­—+èŠ±è‰² -->
          <view class="corner top-left">
            <text>{{item.val}}</text>
            <text class="suit-icon">â™ </text>
          </view>
          
          <!-- ä¸­é—´å¤§æ•°å­—/ç®—å¼ -->
          <view class="card-center">
            <view class="main-num {{item.val >= 100 ? 'small-font' : ''}}">
              {{item.val}}
            </view>
            <!-- åªæœ‰å½“æ˜¾ç¤ºçš„æ•°å­—æ˜¯è®¡ç®—å‡ºæ¥çš„ï¼ˆå³exprå’Œvalä¸åŒï¼‰æ‰æ˜¾ç¤ºç®—å¼ -->
            <view class="sub-expr" wx:if="{{item.expr !== item.val + ''}}">
              {{item.expr}}
            </view>
          </view>

          <!-- å³ä¸‹è§’æ ‡ï¼šæ•°å­—+èŠ±è‰² (æ—‹è½¬) -->
          <view class="corner bottom-right">
            <text>{{item.val}}</text>
            <text class="suit-icon">â™£</text>
          </view>
        </view>
      </block>
    </view>
    
    <view class="target-tips" wx:if="{{cards.length > 0}}">
      <text wx:if="{{operator}}">å½“å‰æ“ä½œ: {{operator}}</text>
      <text wx:else>ç›®æ ‡: 24</text>
    </view>
  </view>

  <!-- 3. æ“ä½œåŒº -->
  <view class="control-panel">
    <!-- è¿ç®—ç¬¦ -->
    <view class="ops-row">
      <view class="op-btn {{operator==='+'?'active':''}}" bindtap="onOpTap" data-op="+">ï¼‹</view>
      <view class="op-btn {{operator==='-'?'active':''}}" bindtap="onOpTap" data-op="-">ï¼</view>
      <view class="op-btn {{operator==='Ã—'?'active':''}}" bindtap="onOpTap" data-op="Ã—">Ã—</view>
      <view class="op-btn {{operator==='Ã·'?'active':''}}" bindtap="onOpTap" data-op="Ã·">Ã·</view>
    </view>
    
    <!-- åŠŸèƒ½é”® -->
    <view class="func-row">
      <button class="func-btn undo" bindtap="undo" disabled="{{history.length === 0}}">â†© æ’¤é”€</button>
      <button class="func-btn hint" bindtap="showAnswer">ğŸ’¡ æç¤º</button>
      <button class="func-btn reset" bindtap="startGame">ğŸ”„ é‡å¼€</button>
    </view>
  </view>
</view>
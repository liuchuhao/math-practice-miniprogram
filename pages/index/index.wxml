<!-- pages/index/index.wxml -->
<view class="container">
  
  <!-- 顶部背景装饰 -->
  <view class="top-bg-shape"></view>

  <!-- 1. 头部区域 -->
  <view class="page-header">
    <view class="header-left">
      <text class="app-greeting">👋 Hi, 同学</text>
      <text class="app-name">今天也要加油鸭！</text>
    </view>
    <view class="header-right">
      <view class="wechat-badge">公众号：刘叔数学训练</view>
    </view>
  </view>

  <!-- 2. 用户名片卡 -->
  <view class="user-card">
    <view class="user-card-inner">
      <view class="avatar-wrap">
        <button class="avatar-btn" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
          <image class="avatar-img" src="{{userInfo.avatarUrl || '/images/default_avatar.png'}}" mode="aspectFill"></image>
        </button>
        <image wx:if="{{currentFrameImg}}" class="frame-overlay" src="{{currentFrameImg}}" mode="aspectFit"></image>
      </view>
      
      <view class="info-box">
        <view class="nickname-row">
          <input type="nickname" class="nickname-input" placeholder="点击设置昵称" value="{{userInfo.nickName}}" bindblur="onNicknameChange" bindinput="onNicknameInput" focus="{{nicknameFocus}}"/>
          <text class="edit-icon">✎</text>
        </view>
        <view class="rank-badge-area" bindtap="showRankRules">
          <view class="rank-pill">
            <text class="rank-icon">🎖️</text>
            <text class="rank-text">{{userTitle}}</text>
          </view>
          <view class="integral-row">
            <text>积分 </text>
            <text class="integral-val">{{userIntegral}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 3. 核心功能区 (去掉了文字标题) -->
  <view class="main-actions">
    <view class="action-card blue" bindtap="startPractice">
      <view class="card-inner">
        <text class="icon">✏️</text>
        <view class="text">
          <text class="title">基础练习</text>
          <text class="desc">巩固基础</text>
        </view>
      </view>
    </view>

    <view class="action-card purple" bindtap="startAdvancedPractice">
      <view class="card-inner">
        <text class="icon">🧩</text>
        <view class="text">
          <text class="title">拓展挑战</text>
          <text class="desc">双倍积分</text>
        </view>
      </view>
    </view>

    <view class="action-card green" bindtap="goToGames">
      <view class="card-inner">
        <text class="icon">🎮</text>
        <view class="text">
          <text class="title">数学游戏</text>
          <text class="desc">趣味闯关</text>
        </view>
      </view>
    </view>
    <view class="action-card cyan" bindtap="goToBrainDev">
      <view class="card-inner">
        <text class="icon">🧠</text>
        <view class="text">
          <text class="title">大脑开发</text>
          <text class="desc">思维训练</text>
        </view>
      </view>
    </view>
    
    <!-- [新增] 问题解决 (粉色) -->
    <view class="action-card pink" bindtap="goToProblemSolving">
      <view class="card-inner">
        <text class="icon">🤔</text>
        <view class="text">
          <text class="title">问题解决</text>
          <text class="desc">应用题专项</text>
        </view>
      </view>
    </view>
    <view class="action-card orange" bindtap="goToRank">
      <view class="card-inner">
        <text class="icon">🏆</text>
        <view class="text">
          <text class="title">英雄榜</text>
          <text class="desc">全网PK</text>
        </view>
      </view>
    </view>
    
  </view>

  <!-- 4. 常用工具 (去掉了标题，按钮加大) -->
  <view class="tools-section">
    <view class="sub-actions">
      <view class="sub-btn" bindtap="goToStore">
        <text class="sub-icon">🎁</text>
        <text>积分商店</text>
      </view>
      <view class="sub-btn" bindtap="goToGradeTestPaper">
        <text class="sub-icon">📝</text>
        <text>生成试卷</text>
      </view>
      <view class="sub-btn" bindtap="viewHistory">
        <text class="sub-icon">📊</text>
        <text>错题本</text>
      </view>
      <view class="sub-btn" bindtap="about">
        <text class="sub-icon">ℹ️</text>
        <text>关于我们</text>
      </view>
    </view>
  </view>
 
  <!-- 底部信息 -->
  <view class="footer">
    <text class="footer-text">本程序由Adam.Liu（刘叔）独立开发</text>
  </view>

</view>
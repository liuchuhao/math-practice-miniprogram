<!-- pages/math_rank/math_rank.wxml -->
<view class="container">
  
  <!-- 1. é¡¶éƒ¨èƒŒæ™¯ä¸å¹´çº§åˆ‡æ¢ -->
  <view class="header-section">
    <view class="rank-title">ğŸ† ç®—åŠ›è‹±é›„æ¦œ</view>
    
    <view class="grade-tabs">
      <block wx:for="{{[1,2,3,4,5,6]}}" wx:key="*this">
        <view 
          class="grade-item {{curGrade === item ? 'active' : ''}}" 
          bindtap="changeGrade" 
          data-grade="{{item}}">
          {{item}}å¹´çº§
        </view>
      </block>
    </view>
  </view>

  <!-- 2. è¡¨å¤´è¯´æ˜ -->
  <view class="list-header">
    <text class="lh-rank">æ’å</text>
    <text class="lh-user">é€‰æ‰‹</text>
    <text class="lh-score">å¾—åˆ†</text>
    <text class="lh-time">è€—æ—¶</text>
  </view>

  <!-- 3. æ’è¡Œæ¦œåˆ—è¡¨ -->
  <scroll-view scroll-y class="rank-list" enable-flex>
    
    <!-- ç©ºçŠ¶æ€æç¤º -->
    <view wx:if="{{rankList.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸƒ</view>
      <text>è¯¥å¹´çº§æš‚æ—¶æ— äººä¸Šæ¦œ</text>
      <text class="empty-tip">å¿«å»ç»ƒä¹ ï¼ŒæŠ¢å ç¬¬ä¸€åï¼</text>
    </view>

    <!-- åˆ—è¡¨é¡¹ -->
    <block wx:for="{{rankList}}" wx:key="id">
      <view class="rank-card {{index < 3 ? 'top-card' : ''}}">
        
        <!-- æ’ååˆ—ï¼šå‰ä¸‰åæ˜¾ç¤ºå¥–ç‰Œ -->
        <view class="col-rank">
          <view wx:if="{{index === 0}}" class="medal">ğŸ¥‡</view>
          <view wx:elif="{{index === 1}}" class="medal">ğŸ¥ˆ</view>
          <view wx:elif="{{index === 2}}" class="medal">ğŸ¥‰</view>
          <view wx:else class="rank-num">{{index + 1}}</view>
        </view>

        <!-- ç”¨æˆ·åˆ—ï¼šå¤´åƒ+æ˜µç§° -->
        <view class="col-user">
          <image 
            class="user-avatar {{index === 0 ? 'avatar-gold' : ''}}" 
            src="{{item.avatar || '/images/default_avatar.png'}}" 
            mode="aspectFill">
          </image>
          <text class="user-name {{index < 3 ? 'name-bold' : ''}}">{{item.nickname || 'ç¥ç§˜é«˜æ‰‹'}}</text>
        </view>

        <!-- æˆç»©åˆ— -->
        <view class="col-score">
          <text class="score-val">{{item.score}}</text>
          <text class="score-unit">åˆ†</text>
        </view>

        <!-- æ—¶é—´åˆ— -->
        <view class="col-time">
          {{item.time_used}}s
        </view>
      </view>
    </block>

    <!-- åº•éƒ¨å ä½ï¼Œé˜²æ­¢æœ€åä¸€åè´´åº• -->
    <view style="height: 50rpx;"></view>
  </scroll-view>

</view>